<div class="container">
  <div class="row justify-content-around">
    <div class="col-12 col-md">
      <app-account-selector [textSize]="1" [showBalance]="false" (selected)="onAccountSelected($event)"></app-account-selector>
      <div class="row m-0" *ngIf="account">{{account.accountNumber}}</div>
    </div>
    <div class="col-12 col-md-auto">
        <div *ngIf="account" class="row justify-content-start justify-content-md-end text-md-right">
          <div class="col-auto">
            <h3 class="thin-text text-dark-gray">{{account.balance | waivCurrency}}</h3>
            <span class="text-dark-gray">Balance</span>
          </div>
          <div class="col">
            <h3 class="thin-text text-brand">{{account.availableBalance | waivCurrency}}</h3>
            <span class="text-brand">Available</span>
          </div>
        </div>
    </div>
  </div>

  <div *ngIf="account" class="mt-3 mt-md-6">
    <form id="transaction-search" [ngClass]="{'show-advanced':showAdvancedSearch == true}" (ngSubmit)="onSearch()" [formGroup]="form">
      <div class="form-row mb-1 mb-md-3">
        <div class="col col-md-4">
          <div class="has-feedback-custom">
            <input type="search" class="form-control" placeholder="Search transactions">
            <span class="form-control-feedback-custom"><i class="fa fa-fw fa-search"></i></span>
          </div>
        </div>
        <div class="col-auto col-md-3">
          <button type="button" class=" btn btn-link" href="#" (click)="showAdvancedSearch = !showAdvancedSearch"><i class="fa fa-animate fa-plus mr-1" [ngClass]="{'fa-rotate-45':showAdvancedSearch==true}"></i>{{showAdvancedSearch == false ? 'Advanced search' : 'Close Search'}}</button>
        </div>
      </div>
      <div [hidden]="!showAdvancedSearch" class="inline">
        <div class="flex-group">
          <label for="dateFrom" class="col-form-label mr-1">From</label>
          <app-date-picker inputId="dateFrom" formControlName="dateFrom" placeholder="Date" class="mr-1"></app-date-picker>
          <label class="col-form-label mr-1" for="dateTo">To</label>
          <app-date-picker inputId="dateTo" formControlName="dateTo" placeholder="Date" class="mr-2"></app-date-picker>
        </div>
        <div id="middle-flex" class="flex-group">
          <label class="col-form-label mr-1" for="type">Type</label>
          <select id="type" formControlName="type" class="custom-select form-control mr-2">
            <option value="all"> All transactions</option>
            <option value="pending">Pending</option>
            <option value="posted">Finished</option>
          </select>
        </div>
        <div class="flex-group">
          <label for="amountFrom" class="col-form-label mr-1">From</label>
          <div class="has-feedback-custom mr-1">
            <input id="amountFrom" formControlName="amountFrom" class="form-control " placeholder="Amount">
            <span class="form-control-feedback-custom"><i class="fa fa-fw fa-dollar"></i></span>
          </div>
          <label for="amountTo" class="col-form-label mr-1">To</label>
          <div class="has-feedback-custom mr-2">
            <input id="amountTo" formControlName="amountTo" class="form-control " placeholder="Amount">
            <span class="form-control-feedback-custom"><i class="fa fa-fw fa-dollar"></i></span>
          </div>
        </div>
        <button type="submit" value="Search" class="form-control search-btn" [disabled]="searchTransactions?.inProgress() || !form.valid">
         <i class="fa fa-search"></i>
       </button>
      </div>
    </form>

    <div *ngIf="!searchTransactions?.inProgress() && transactions.length == 0">
      [no results]
    </div>

    <div class="row" *ngIf="transactions.length > 0">
      <div class="col-12 ">
        <app-transaction-list [transactionList]="transactions" class="x-sm-scroll"></app-transaction-list>
      </div>
      <div *ngIf="hasMoreToLoad() && !searchTransactions?.inProgress()" class="col-12 text-center">
        <button [disabled]="searchTransactions?.inProgress()" (click)="onLoadMore()" class="col-12 btn btn-link my-4">load more</button>
      </div>
    </div>

    <div class="row" *ngIf="searchTransactions?.inProgress()">
      <div class="col-12 text-center">
        <i aria-hidden="true" class="fa fa-circle-o-notch fa-spin fa-4x fa-fw my-3"></i>
        <span class="sr-only">Loading...</span>
      </div>
    </div>


    <div *ngIf="searchTransactions?.errorResponse" class="alert alert-danger">{{searchTransactions.errorResponse.error | json}}</div>


  </div>
</div>
